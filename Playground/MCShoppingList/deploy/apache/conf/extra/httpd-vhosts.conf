#
# Virtual Hosts
#
# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at 
# <URL:http://httpd.apache.org/docs/2.2/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

Listen 80
Listen 888
Listen 889
# See also: httpd-ssl.conf
Listen 443


#
# Use name-based virtual hosting.
# http://httpd.apache.org/docs/2.0/ssl/ssl_faq.html#vhosts2
# *:80 or IP:80 
NameVirtualHost *:80
NameVirtualHost *:443
NameVirtualHost *:888

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#

######################################
# Default 
<VirtualHost *:80>
    ServerName m1.xen.prgmr.com
    DocumentRoot "/srv/www/default/htdocs"

    ErrorLog "/srv/www/default/logs/error.log"
    CustomLog "/srv/www/default/logs/access.log" combined
    LogLevel warn

    <Directory "/srv/www/default/htdocs">
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost>


######################################
# mcshoppinglist

<VirtualHost *:888>
    ServerName m1.xen.prgmr.com
    DocumentRoot "/srv/www/mcshoppinglist/htdocs"

    ErrorLog "/srv/www/mcshoppinglist/logs/error.log"
    CustomLog "/srv/www/mcshoppinglist/logs/access.log" combined
    LogLevel warn

    WSGIScriptAlias / "/srv/mcshoppinglist/hg/Playground/DjangoRestServer/helloWorldService/helloWorld.wsgi.py"
    #Alias /static "/srv/mcshoppinglist/hg/Playground/DjangoRestServer/helloWorldService/"

    <Directory "/srv/mcshoppinglist/hg/Playground/DjangoRestServer/helloWorldService/">
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost>


<VirtualHost *:889>
    ServerName m1.xen.prgmr.com
    DocumentRoot "/srv/www/mcshoppinglist-dev-889/htdocs"

    ErrorLog "/srv/www/mcshoppinglist-dev-889/logs/error.log"
    CustomLog "/srv/www/mcshoppinglist-dev-889/logs/access.log" combined
    LogLevel warn

    # From: http://docs.pylonsproject.org/projects/pyramid/dev/tutorials/modwsgi/index.html
    # Use only 1 Python sub-interpreter.  Multiple sub-interpreters
    # # play badly with C extensions.
    WSGIApplicationGroup %{GLOBAL}
    WSGIPassAuthorization On
    WSGIDaemonProcess pyramid user=www-data group=www-data processes=1 \
       threads=4 \
       python-path=/srv/mcshoppinglist/virtualenv/development/lib/python2.7/site-packages/
    WSGIScriptAlias / "/srv/mcshoppinglist/development/Playground/MCShoppingList/mcshoppinglist/wsgiapp/mcshoppinglist.wsgi"
    
    <Directory "/srv/mcshoppinglist/development/Playground/MCShoppingList">
        WSGIProcessGroup pyramid
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost>



#############################
##
## SSL Virtual Host Context
##

<VirtualHost *:443>

    #   General setup for the virtual host
    DocumentRoot "/srv/www/default-443/htdocs"
    ServerName m1.xen.prgmr.com:443
    ServerAdmin m1@mailzone.com
    ErrorLog "/srv/www/default-443/logs/error.log"
    CustomLog "/srv/www/default-443/logs/access.log" combined
    LogLevel warn
    
    #   SSL Engine Switch:
    #   Enable/Disable SSL for this virtual host.
    SSLEngine on
    
    #   SSL Cipher Suite:
    #   List the ciphers that the client is permitted to negotiate.
    #   See the mod_ssl documentation for a complete list.
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    
    #   Server Certificate:
    #   Point SSLCertificateFile at a PEM encoded certificate.  If
    #   the certificate is encrypted, then you will be prompted for a
    #   pass phrase.  Note that a kill -HUP will prompt again.  Keep
    #   in mind that if you have both an RSA and a DSA certificate you
    #   can configure both in parallel (to also allow the use of DSA
    #   ciphers, etc.)
    SSLCertificateFile "/opt/apache/ssl/server.crt"
    
    #   Server Private Key:
    #   If the key is not combined with the certificate, use this
    #   directive to point at the key file.  Keep in mind that if
    #   you've both a RSA and a DSA private key you can configure
    #   both in parallel (to also allow the use of DSA ciphers, etc.)
    SSLCertificateKeyFile "/opt/apache/ssl/server.key"

    # See httpd-ssl.conf for explanation. IE sucks.
    BrowserMatch ".*MSIE.*" \
             nokeepalive ssl-unclean-shutdown \
             downgrade-1.0 force-response-1.0


    # Site stuff
    
    ScriptAlias /hg "/srv/www/default-443/htdocs/cgi/hgweb.cgi"

    <Directory "/srv/www/default-443/htdocs/cgi/">
        Order allow,deny
        Allow from all
    </Directory>

    <Directory "/srv/www/default-443/htdocs/">
        Order allow,deny
        Allow from all
    </Directory>

    <Location /hg>
        AuthType Basic
        AuthName "Mercurial Repositories"
        AuthUserFile "/srv/www/default-443/auth/hgusers"
    
#        <LimitExcept GET>
            Require valid-user
#        </LimitExcept>
    </Location>

</VirtualHost>                                  

